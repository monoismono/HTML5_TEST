(function(){"use strict";var h=function(a){return"gwd-page"==a.tagName.toLowerCase()||"gwd-page"==a.getAttribute("is")},l=function(a){if(h(a))return a;for(;a&&9!=a.nodeType;)if((a=a.parentElement)&&h(a))return a;return null};var m=function(a){a=a.trim();return window.Enabler?Enabler.getUrl(a):a};var n=function(a,b,c){return a>b==c/2>Math.abs(a-b)?"forwards":"backwards"};var p=function(a){setTimeout(a,0)};var q=function(a,b,c){var d;c?(d=document.createEvent("CustomEvent"),d.initCustomEvent(a,!0,!0,c)):(d=document.createEvent("Event"),d.initEvent(a,!0,!0));b.dispatchEvent(d);return d},r=function(a,b){var c=function(d){a.removeEventListener("attached",c);b(d)};a.addEventListener("attached",c)};var s=["-ms-","-moz-","-webkit-",""];var t=function(a){var b=document.createElement("img","gwd-image");b.setAttribute("source",a);return b},u=function(a){var b=[];if(a){a=a.split(",");for(var c=0;c<a.length;++c)b.push(t(m(a[c])))}return b},v=function(a,b){return(a%b+b)%b};document.register&&document.registerElement("gwd-360gallery",{prototype:Object.create(HTMLElement.prototype,{createdCallback:{value:function(){this.h=!1;this.f=null;this.a=0;this.b=-1;this.p=0;this.d=[];var a=document.createElement("gwd-gesture");a.className="gesture";this.e=a;this.n=this.onTrackStart_.bind(this);this.m=this.onTrack_.bind(this);this.l=this.onTap_.bind(this);this.j=q.bind(null,"firstinteraction",this);this.q=this.onFramesLoad_.bind(this);this.g=[];this.k=0;this.c=null;this.o=this.hasAttribute("images");
this.i=null},enumerable:!0},attachedCallback:{value:function(){this.e.addEventListener("trackstart",this.n,!1);this.e.addEventListener("track",this.m,!1);this.e.addEventListener("tap",this.l,!1);this.c=null;l(this)||"function"!=typeof this.gwdLoad||("function"==typeof this.gwdIsLoaded?this.gwdIsLoaded()||this.gwdLoad():this.gwdLoad())},enumerable:!0},detachedCallback:{value:function(){this.e.removeEventListener("trackstart",this.n,!1);this.e.removeEventListener("track",this.m,!1);this.e.removeEventListener("tap",
this.l,!1);clearTimeout(this.c)},enumerable:!0},goToFrame:{value:function(a,b,c){!this.c&&0<a&&a<=this.a&&(a=v(a-1,this.a),this.stepToFrame_(this.b,a,b||"slide",c||n(a,this.b,this.a),300))},enumerable:!0},rotateOnce:{value:function(a,b){var c=a&&b&&"string"==typeof a&&"number"==typeof b,d=(c?a:b)||"forwards",f=(c?b:a)||300*this.a;if(!this.c&&1<this.a){var e=this.b,g=v(this.b+("left"==d||"backwards"==d?-1:1),this.a);p(function(){this.stepToFrame_(g,e,"slide",d,f/this.a)}.bind(this))}},enumerable:!0},
gwdIsLoaded:{value:function(){return this.h},enumerable:!0},gwdLoad:{value:function(){if(!this.h&&!this.f){var a;if(this.o)a=u(this.getAttribute("images"));else{a=this.childNodes;for(var b=[],c=0,d=a.length;c<d;c++)a[c].nodeType==Node.ELEMENT_NODE&&b.push(a[c]);a=b}this.d=a;this.loadFrames_()}},enumerable:!0},loadFrames_:{value:function(){for(;this.firstChild;)this.removeChild(this.firstChild);this.f&&this.f.removeEventListener("pageload",this.q,!1);for(var a=this.d,b=document.createElement("div",
"gwd-page"),c,d=0;d<a.length;++d){for(var f=c=a[d],e=void 0,g=void 0,k=0;k<s.length;++k)e=s[k]+"user-select",g="none",f.style.setProperty(e,g);c.classList.add("frame");b.appendChild(c)}r(b,b.gwdLoad.bind(b));this.f=b;b.addEventListener("pageload",this.q,!1);this.appendChild(b);this.appendChild(this.e)},enumerable:!1},onFramesLoad_:{value:function(a){if(this.f===a.target){a=this.d;for(var b=this.clientWidth,c=this.clientHeight,d,f=b/c,e,g,k=0;k<a.length;++k)d=a[k],"img"==d.tagName.toLowerCase()&&(e=
d.offsetWidth/d.offsetHeight,f>e?(g=c*e,e=c):(g=b,e=b/e),d.style.width=g+"px",d.style.height=e+"px");this.h=!0;this.removeChild(this.f);this.a=this.d.length;this.g=[];this.k=this.a;this.displayFrame_(0);this.f=null;q("imagesloaded",this);q("allframesloaded",this);this.hasAttribute("autoplay")&&setTimeout(this.rotateOnce.bind(this),0);q("ready",this)}},enumerable:!1},attributeChangedCallback:{value:function(a){"images"==a&&(this.o=!0,this.a=0,this.b=-1,this.d=u(this.getAttribute(a)),this.loadFrames_(),
clearTimeout(this.c))},enumerable:!0},onTrackStart_:{value:function(){this.a&&!this.c&&(this.p=this.b)},enumerable:!1},onTrack_:{value:function(a){this.a&&!this.c&&(this.j&&(this.j(),this.j=null),this.displayFrame_(v(this.p+Math.round(a.dx/50),this.a)))},enumerable:!1},onTap_:{value:function(){this.a&&q("frametap",this,{id:this.currentIndex})},enumerable:!1},displayFrame_:{value:function(a){if(this.b!=a&&this.d[a]){this.b=a;var b=this.i;this.i=this.d[a];this.appendChild(this.i);b&&this.removeChild(b);
q("frameshown",this,{id:this.currentIndex});this.g[a]||(this.g[a]=!0,--this.k||q("allframesviewed",this))}},enumerable:!1},stepToFrame_:{value:function(a,b,c,d,f){"none"==c&&(a=b);this.displayFrame_(a);a!=b?(a=v(a+("left"==d||"backwards"==d?-1:1),this.a),this.c=setTimeout(this.stepToFrame_.bind(this,a,b,c,d,f),f)):this.c=null},enumerable:!1},currentIndex:{enumerable:!0,get:function(){return this.a?this.b+1:void 0}},getFrame:{value:function(a){return this.d[a-1]},enumerable:!0},goForwards:{value:function(){this.goToFrame(this.b+
2,"none")},enumerable:!0},goBackwards:{value:function(){this.goToFrame(this.b,"none")},enumerable:!0}})});})()
