(function(){"use strict";var h=function(a){return"gwd-page"==a.tagName.toLowerCase()||"gwd-page"==a.getAttribute("is")},k=function(a){if(h(a))return a;for(;a&&9!=a.nodeType;)if((a=a.parentElement)&&h(a))return a;return null};var l=["-ms-","-moz-","-webkit-",""],m=function(a,b,c,d){for(var e,g,f=0;f<l.length;++f)e=l[f]+b,g=(d?l[f]:"")+c,a.style.setProperty(e,g)};var n=function(a,b,c){var d;c?(d=document.createEvent("CustomEvent"),d.initCustomEvent(a,!0,!0,c)):(d=document.createEvent("Event"),d.initEvent(a,!0,!0));b.dispatchEvent(d);return d},p=function(a,b){var c=function(d){a.removeEventListener("attached",c);b(d)};a.addEventListener("attached",c)};var q=function(a){a=a.trim();return window.Enabler?Enabler.getUrl(a):a};var r=function(a){var b=document.createElement("img","gwd-image");b.setAttribute("source",a);return b},s=function(a){var b=[];if(a){a=a.split(",");for(var c=0;c<a.length;++c)b.push(r(q(a[c])))}return b},t=function(a,b){for(var c=document.createElement("div","gwd-page"),d,e=0;e<a.length;++e)d=a[e],m(d,"user-select","none"),d.classList.add("frame"),b&&b(d),c.appendChild(d);p(c,c.gwdLoad.bind(c));return c},v=function(a,b){for(var c=b.length,d=b.splice(0,c),e,g=0;g<c;g++)e=d[g],"frameshown"==e?n(e,a,
{id:a.currentIndex}):n(e,a)},w=function(a,b){return(a%b+b)%b};var x=function(a,b,c){return a.hasAttribute(b)?parseInt(a.getAttribute(b),10):c},y=function(a){return{autoplay:a.hasAttribute("autoplay"),o:x(a,"frame-width",160),H:x(a,"frame-height",80),C:x(a,"neighbor-rotation-y",38),D:x(a,"neighbor-translation-x",20),F:x(a,"neighbor-translation-y",-8),G:x(a,"neighbor-translation-z",-80),transitionDuration:x(a,"transition-duration",600),I:a.hasAttribute("show-reflection"),B:x(a,"start-frame",2)}},z=function(a,b,c,d){var e=0;a=t(a,function(a){a.style.left=e+"px";
a.style.width=b+"px";a.style.height=c+"px";e+=b});a.className="container"+(d?" reflection":"");return a},A=function(a,b,c,d,e){b="translate3d("+b+"px, "+c+"px, "+d+"px)";e&&(b="rotate3d(0, 1, 0, "+e+"deg) "+b);m(a,"transform",b)},B=function(a,b){m(a,"transition","transform "+b+"ms",!0)};var C=function(a,b){return setInterval(a,b)};document.registerElement&&document.registerElement("gwd-carouselgallery",{prototype:Object.create(HTMLElement.prototype,{createdCallback:{value:function(){this.l=!1;this.f=null;this.a=0;this.c=-1;this.k=0;this.d=[];var a=document.createElement("gwd-gesture");a.className="gesture";this.e=a;this.u=this.onTrackStart_.bind(this);this.t=this.onTrack_.bind(this);this.s=this.onTrackEnd_.bind(this);this.r=this.onTap_.bind(this);this.m=n.bind(null,"firstinteraction",this);this.q=this.onFramesLoad_.bind(this);
this.v=!1;this.n=[];this.g=v.bind(null,this,this.n);this.j=[];this.p=0;this.w=this.hasAttribute("images");this.b=y(this);this.A=this.i=0;this.h=null},enumerable:!0},attachedCallback:{value:function(){this.i=this.i||this.clientWidth/2;this.e.addEventListener("trackstart",this.u,!1);this.e.addEventListener("track",this.t,!1);this.e.addEventListener("trackend",this.s,!1);this.e.addEventListener("tap",this.r,!1);this.addEventListener("transitionend",this.g,!1);this.addEventListener("webkitTransitionEnd",
this.g,!1);k(this)||"function"!=typeof this.gwdLoad||("function"==typeof this.gwdIsLoaded?this.gwdIsLoaded()||this.gwdLoad():this.gwdLoad())},enumerable:!0},detachedCallback:{value:function(){this.e.removeEventListener("trackstart",this.u,!1);this.e.removeEventListener("track",this.t,!1);this.e.removeEventListener("trackend",this.s,!1);this.e.removeEventListener("tap",this.r,!1);this.removeEventListener("transitionend",this.g);this.removeEventListener("webkitTransitionEnd",this.g)},enumerable:!0},
currentIndex:{enumerable:!0,get:function(){return this.a?this.c+1:void 0}},goToFrame:{value:function(a,b){var c="none"!=b,d=this.b.transitionDuration;0<a&&a<=this.a&&(this.stopRotation_(),this.setTransition_(c?d:0),this.centerFrame_(a-1))},enumerable:!0},goBackwards:{value:function(a){this.goToFrame(this.currentIndex-1,a||"slide")},enumerable:!0},goForwards:{value:function(a){this.goToFrame(this.currentIndex+1,a)},enumerable:!0},rotateOnce:{value:function(a,b){var c=a||this.b.transitionDuration*this.a,
d=b||"forwards",e=this.b.transitionDuration;this.a&&!this.h&&(this.A=this.c,this.setTransition_(e),this.updateFrames_(w(this.c+("left"==d||"backwards"==d?-1:1),this.a),0),this.h=C(function(){this.updateFrames_(w(this.c+("left"==d||"backwards"==d?-1:1),this.a),0);this.A==this.c&&this.stopRotation_()}.bind(this),c/this.a))},enumerable:!0},stopRotation_:{value:function(){this.h&&(clearInterval(this.h),this.h=null)},enumerable:!1},gwdIsLoaded:{value:function(){return this.l},enumerable:!0},gwdLoad:{value:function(){if(!this.l&&
!this.f){var a;if(this.w)a=s(this.getAttribute("images"));else{a=this.childNodes;for(var b=[],c=0,d=a.length;c<d;c++)a[c].nodeType==Node.ELEMENT_NODE&&b.push(a[c]);a=b}this.d=a;this.loadFrames_()}},enumerable:!0},getFrame:{value:function(a){return this.d&&this.d[a-1]},enumerable:!0},loadFrames_:{value:function(){for(;this.firstChild;)this.removeChild(this.firstChild);this.f&&this.f.removeEventListener("pageload",this.q,!1);var a=this.b;this.f=a=z(this.d,a.o,a.H,a.I);a.addEventListener("pageload",
this.q,!1);this.appendChild(a);this.appendChild(this.e)},enumerable:!1},onFramesLoad_:{value:function(a){if(this.f===a.target){this.l=!0;this.a=this.d.length;this.j=[];if(this.p=this.a){a=this.b.B-1;if(0>a||a>=this.a)a=0;this.setTransition_(0);this.centerFrame_(a);this.b.autoplay&&setTimeout(this.rotateOnce.bind(this),0)}n("allframesloaded",this);n("ready",this)}},enumerable:!1},attributeChangedCallback:{value:function(a){"images"==a?(this.w=!0,this.a=0,this.c=-1,this.d=s(this.getAttribute(a)),this.loadFrames_()):
this.b=y(this)},enumerable:!0},onTrackStart_:{value:function(){this.a&&(this.stopRotation_(),this.k=this.c,this.setTransition_(0))},enumerable:!1},onTrack_:{value:function(a){if(this.a){this.m&&(this.m(),this.m=null);a=-a.dx/this.b.o;var b=Math.round(a);this.updateFrames_(this.k+b,a-b)}},enumerable:!1},onTrackEnd_:{value:function(){if(this.a){this.setTransition_(this.b.transitionDuration);var a=this.c;this.centerFrame_(a);this.k!=a&&(0==a?n("reachleftend",this):a==this.a-1&&n("reachrightend",this))}},
enumerable:!1},onTap_:{value:function(){this.a&&n("frametap",this,{id:this.currentIndex})},enumerable:!1},setTransition_:{value:function(a){this.v=0<a;this.f&&B(this.f,a);for(var b=0;b<this.a;++b)B(this.d[b],a)},enumerable:!1},centerFrame_:{value:function(a){this.d[a]&&(this.c=a,this.updateFrames_(a,0,this.a),this.n.push("frameshown"),this.j[a]||(this.j[a]=!0,--this.p||this.n.push("allframesviewed")));this.v||this.g()},enumerable:!1},updateFrames_:{value:function(a,b,c){for(var d=this.b,e,g=c||1,
f=-g;f<=g;++f)if((c=this.d[f+a])&&0<=b*f){0>f?e=1-Math.abs(b):0<f?e=Math.abs(b)-1:(this.c=a,e=b);var u=Math.abs(e);A(c,d.D*e,d.F*u,d.G*u,d.C*e)}A(this.f,this.i-(a+b+.5)*d.o,0,0)},enumerable:!1}})});})()
